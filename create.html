<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Create Student</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://unpkg.com/browser-image-compression@1.0.15/dist/browser-image-compression.js"></script>
  <script src="js/config.js"></script>
  <script src="js/app.js"></script>
  <style>img.preview{width:80px;height:80px;object-fit:cover;margin-right:6px;border-radius:6px;}</style>
</head>
<body class="p-3">
  <div class="container">
    <div class="d-flex justify-content-between mb-3">
      <h4 id="formTitle">Create Student</h4>
      <div>
        <button id="btnBack" class="btn btn-light">Back</button>
        <button id="btnLogout" class="btn btn-outline-secondary">Logout</button>
      </div>
    </div>

    <form id="studentForm" novalidate>
      <div class="row">
        <div class="col-md-6 mb-2">
          <label>Name *</label>
          <input id="name" class="form-control" required />
        </div>
        <div class="col-md-2 mb-2">
          <label>Age *</label>
          <input id="age" type="number" min="1" class="form-control" required />
        </div>
        <div class="col-md-4 mb-2">
          <label>Date of Birth *</label>
          <input id="dob" type="date" class="form-control" required />
        </div>
        <div class="col-md-12 mb-2">
          <label>Address</label>
          <textarea id="address" class="form-control"></textarea>
        </div>

        <div class="col-md-6 mb-2">
          <label>State</label>
          <div class="input-group">
            <select id="state" class="form-control">
              <option value="">-- Select State --</option>
            </select>
            <button id="btnSaveState" type="button" class="btn btn-outline-primary">Save State Name</button>
          </div>
        </div>

        <div class="col-md-6 mb-2">
          <label>Phone *</label>
          <input id="phone" class="form-control" type="text" pattern="[0-9]{10}" maxlength="10" placeholder="9876543210" required />
        </div>

        <div class="col-md-12 mb-2">
          <label>Photos (multiple)</label>
          <input id="photos" type="file" accept="image/*" multiple class="form-control" />
          <div id="photoPreview" class="mt-2"></div>
        </div>

        <div class="col-md-12 mt-3">
          <label>Subjects</label>
          <div id="subjectsContainer"></div>
          <div class="mt-2">
            <button id="addSubjectBtn" type="button" class="btn btn-sm btn-success">Add</button>
          </div>
        </div>

      </div>

      <div class="mt-3">
        <button type="submit" class="btn btn-primary">Submit</button>
      </div>
    </form>
  </div>

  <script>
    // ensure at least one subject row
    document.addEventListener("DOMContentLoaded", ()=>{
      if (!document.querySelector(".subject-name")) {
        appendSubjectRowValue("");
      }
    });
    // provide append helper for inline use
    window.appendSubjectRowValue = function(v){ const container=document.getElementById("subjectsContainer"); const div=document.createElement("div"); div.className="d-flex mb-2"; div.innerHTML=`<input class="form-control subject-name" value="${(v||'').replace(/"/g,'&quot;')}" placeholder="Subject name" /><button class="btn btn-danger ms-2 btn-remove-subject" type="button">Delete</button>`; container.appendChild(div); div.querySelector(".btn-remove-subject").addEventListener("click",()=>div.remove()); };
  </script>

  <script>initCreatePage();</script>
</body>
</html>
